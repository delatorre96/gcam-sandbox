- Error en module_socio_L101.Population en línea 60 en donde había un filtro con el año 2021 a mano: 
L100.Pop_thous_SSP_ctry_Yfut_raw %>%
      complete(nesting(scenario, iso),
               year = c(2021:max(FUTURE_YEARS))) %>%
      filter(year %in% c(2021:max(FUTURE_YEARS))) 
Yo lo cambio por 2015

- Error en Line 54 construyendo L100.Pop_thous_SSP_ctry_Yfut_raw, miro module_socio_L100.SSP_database y veo que es un problema de los inputs socioeconomics/SSP/SSP_database_2025, los cuales llegan hasta 2021 como años históricos. Los cambio usando script de R:csv_SSP.R, esto lo que hace es que en los propios datos de los escenarios SS1 se consideren como años históricos hasta 2015 y poner 2017,18,19,20 y 21 dentro de las proyecciones SSP.


- Error en línea 176 de module_socio_L102.GDP: El problema viene dado porque como he eliminado 2020 de los años base, al hacer un left_join_error_no_match entre dos objetos donde uno existía el año 2020 y otro no (pop.thous.scen.rgn.yr no existía año 2020 y gdp.mil90usd.scen.rgn.yr sí existía), no podía hacer un match sin NaNs. Para corregirlo reconstruyo gdp.mil90usd.scen.rgn.yr en línea 129 sustituyendo el filtro final filter(year >= min(HISTORICAL_YEARS)) por filter(year %in% c(HISTORICAL_YEARS, FUTURE_YEARS)), el cual dejo todos los años menos 2020.

- Error en module_socio_L102.GDP, en linea 211. En línea 82 se construye el objeto: gdp_bilusd_rgn_Yfut que, por alguna razón en el año 2015 (base year) es 0, eso da error posteriormente en la línea 211. gdp_bilusd_rgn_Yfut viene de L100.GDP_bilusd_SSP_ctry_Yfut_raw que a su vez de construye en socio_L100.SSP_database
En zsocio_L100.SSP_database he sustituido  "mutate(value = if_else(year < socioeconomics.SSP_DB_BASEYEAR, hist, value)) %>%" por  "mutate(value = if_else(is.na(value), hist, value)) %>%" para que en el chunk que construye el objeto gdp_bilusd_rgn_Yfut no se me quede en 2015 a 0.


- Error en module_water_L173.EFW_manufacturing Linea 208 ya que L132.water_km3_ctry_ind_Yh llega hasta 2021 
	miro en module_water_L132.water_demand_manufacturing y veo que el input L101.en_bal_EJ_ctry_Si_Fi_Yh_full llega hasta 2021 .
	Miro en module_energy_L101.en_bal_IEA y veo que como uno de los inputs L100.IEA_en_bal_ctry_hist, si sale null, el chunk hace un prebuilt (extract_prebuilt_data) con L101.en_bal_EJ_R_Si_Fi_Yh_full, L101.en_bal_EJ_ctry_Si_Fi_Yh_full, L101.in_EJ_ctry_trn_Fi_Yh, L101.in_EJ_ctry_bld_Fi_Yh y los carga desde dentro de gcamdata. Estos datos llegan hasta 2021. Como creo que no puedo cambiar esa base de datos interna del prebuilt, entonces modifico el propio chunk para que sus datos lleguen hasta 2015 (hago un filtro antes del return)

- Error en module_aglu_L125.LC_tot, parece que esto se debe a que el data frame: L125.LC_bm2_R_Yh_GLU construido a través de todos los inputs (L124.LC_bm2_R_Shrub_Yh_GLU_adj, L124.LC_bm2_R_Grass_Yh_GLU_adj, L124.LC_bm2_R_UnMgdPast_Yh_GLU_adj, L124.LC_bm2_R_UnMgdFor_Yh_GLU_adj, L123.LC_bm2_R_MgdPast_Yh_GLU, L123.LC_bm2_R_MgdFor_Yh_GLU, L120.LC_bm2_R_UrbanLand_Yh_GLU, L120.LC_bm2_R_Tundra_Yh_GLU, L120.LC_bm2_R_RckIceDsrt_Yh_GLU, L122.LC_bm2_R_HarvCropLand_Yh_GLU, L122.LC_bm2_R_OtherArableLand_Yh_GLU), no pasa el threshold aglu.LAND_TOLERANCE. Es decir, se comprueba que la tasa de cambio anual esté dentro de la tolerancia fija (0.5%) de aglu.LAND_TOLERANCE y considera que hay una fluctuación interanual anormal (mayor que 0.5%). Miro cómo se han construido estos inputs para determinar la causa. Esto quiere decir que tengo que inspeccionar los chunks que construyen estos inputs: zaglu.L124, zaglu.L123, zaglu.L120. 
Pruebo a comentar las lineas de codigo en donde se da este error y entonces paso adelante pero no sé si es muy riguroso.


- Error en module_energy_L244.building_det en línea 307 (left_join_error_no_match). Es un join de un objeto que tiene el año 2020 y otro que no (ya que lo hubimos eliminado e intercambiado por 2021). Concretamente, L144.income_shares es que tiene el año 2020.
Sustituyo en input/gcamdata/inst/extdata/energy/A44.CalPrice_bld.csv y en input/gcamdata/inst/extdata/socioeconomics/income_shares.csv todos los 2020 por todos los 2021

- Error en  module_emissions_L252.MACC en línea 162. En esa linea un data frame resultante se introduce en la función emissions.EPA_MACC_YEAR en donde hace transformaciones como incluir años de mac_reduction_adder emissions.EPA_MACC_YEAR el cual incluye 2020 en vez de 2021. Lo cambio en constants

- Error en module_emissions_L252.MACC de nuevo. ME doy cuenta que viene dado porque como el year que se estimaba antes era 2025 y ahora debería ser 2020 si usamos 2015 como base year (pero 2020 se elimina por causas del covid y se usa 2021), existe un problema que antes no existía: bases de datos con el año incorrecto a estimar. Las bases de datos que usa este chunk tiene 2020 y 2025 pero no 2021, lo cual hace difícil su unión con otras tablas o con conmstants.R que especifican 2021. Por eso, en los csvs sustituyo todos los 2020 por 2021. Concretamente aquí:
input/gcamdata/inst/extdata/emissions/EPA/EPA_2019_MACC_Ag_updated_baseline.csv
input/gcamdata/inst/extdata/emissions/EPA/EPA_2019_MACC_raw.csv.gz
input/gcamdata/inst/extdata/energy/A44.CalPrice_bld.csv
input/gcamdata/inst/extdata/socioeconomics/income_shares.csv

Con estos cambios el Data System funciona y se ejecuta correctamente. Sin embargo cuando corro GCAM me saca error. Creo que viene dado por el las líneas de código que comenté en module_aglu_L125.LC_tot. 





- Error en module_gcamusa_L171.nonghg_trn en línea 349. El error viene de la construccion de MARKAL_LDV_EFs_gpm_CYb que a su vez se construye por MARKAL_LDV_EFs_gpm.long, el cual se forma en la línea 316 e incluye: mutate(year = if_else(year == 2020, 2021L, year)). Comento el mutate y consigo pasar adelante hasta la línea 492, con la construccion del objeto MARKAL_HDV_EFs_gpm_CYb. El error es el mismo y  además también viene de un objeto que tiene un mutate exactamente igual (MARKAL_HDV_EFs_gpm.long, linea 463). Vuelvo a comentar el mutate 





- Error en module_emissions_L253.emission_controls en línea 282






Error en línea 110 en module_aglu_L107.an_IMAGE_R_C_Sys_Fd_Y a la hora de construir L107.an_Prod_Mt_ctry_C_Sys_Fd_Y??






